{% extends "_cover.html" %}

{% load account %}
{% load widget_tweaks %}

{% block title %}Password reset | {{ block.super }}{% endblock %}

{% block body_content %}
  <div class="row justify-content-center">
    <div class="col-lg-4 black-transparent-blackground p-5">
      <h5 class="px-1 mb-0 text-center">
        {% if token_fail %}Bad Token{% else %}Password Reset{% endif %}
      </h5>
      {% if token_fail %}
        {% url 'account_reset_password' as passwd_reset_url %}
        <p>The password reset link was invalid, possibly because it has already been used.  Please request a <a href="{{ passwd_reset_url }}">new password reset</a>.</p>
      {% else %}
        {% if form %}
          <form method="POST" action=".">
            {% csrf_token %}

            {% if form.non_field_errors %}
              <div class="alert alert-danger" role="alert">{{ form.non_field_errors }}</div>
            {% endif %}
            
            {% render_field form.password1 class+="form-control mb-3" %}
            {% if form.password1.errors %}
              {% for error in form.password1.errors %}
                <div class="alert alert-danger" role="alert">{{ error|escape }}</div>
              {% endfor %}
            {% endif %}
            
            {% render_field form.password2 class+="form-control mb-3" %}
            {% if form.password2.errors %}
              {% for error in form.password2.errors %}
                <div class="alert alert-danger" role="alert">{{ error|escape }}</div>
              {% endfor %}
            {% endif %}

            <div class="d-grid">
              <button class="btn btn-success mt-5" name="action" type="submit">Change password</button>
            </div>
          </form>
        {% else %}
          <p>Your password has been changed.</p>
        {% endif %}
      {% endif %}
    </div>
  </div>
{% endblock %}
